package io.sarl.api.protocol.examples.prescription.pharmacist

import io.sarl.api.core.Initialize
import io.sarl.api.core.Logging
import io.sarl.api.core.SpaceCreated
import io.sarl.api.protocol.ProtocolEnactment
import io.sarl.api.protocol.ProtocolEnactmentSkill
import io.sarl.api.protocol.examples.prescription._generated.PrescriptionRole
import io.sarl.api.protocol.examples.prescription._generated.events.RxBound
import io.sarl.api.protocol.examples.prescription._generated.pharmacist.PharmacistProtocolCapacity
import io.sarl.api.protocol.examples.prescription._generated.^space.PrescriptionSpaceSpecification
import io.sarl.lang.core.EventSpace

agent PharmacistAgent {
	
	uses ProtocolEnactment, PharmacistProtocolCapacity, PharmacistInnerCapacity, Logging
	
	var prescriptionSpace : EventSpace

	on Initialize {
		loggingName = "Pharmacist"
	}
	
	on SpaceCreated [it.spaceID.spaceSpecification == PrescriptionSpaceSpecification] {
		setSkill(new ProtocolEnactmentSkill)
		setSkill(new PharmacistInnerSkill)
		prescriptionSpace = enact(occurrence.spaceID, PrescriptionRole.PHARMACIST)
	}

	on RxBound {
		var pkg = preparePkg(rx)
		setPkg(pkg)
	}
	
}
